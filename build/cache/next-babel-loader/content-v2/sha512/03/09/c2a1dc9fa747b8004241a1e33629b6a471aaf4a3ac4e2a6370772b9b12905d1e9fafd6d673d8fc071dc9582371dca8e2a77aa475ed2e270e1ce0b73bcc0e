{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"/data/source/tuyendungvn-user-frontend-nextjs/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/data/source/tuyendungvn-user-frontend-nextjs/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState, useCallback, useEffect, Fragment } from \"react\";\nimport Cropper from \"react-easy-crop\";\nimport { useTranslation } from \"next-i18next\";\nimport Button from \"@designs/Button\";\nimport { getCroppedImg, readFile } from \"@common/functions\";\nimport { Dialog, Transition } from \"@headlessui/react\";\n\nvar ImageCropper = function ImageCropper(props) {\n  var image = props.image,\n      _props$aspect = props.aspect,\n      aspect = _props$aspect === void 0 ? 1 : _props$aspect,\n      onConfirm = props.onConfirm,\n      onClose = props.onClose,\n      _props$isOpen = props.isOpen,\n      isOpen = _props$isOpen === void 0 ? false : _props$isOpen,\n      _props$shape = props.shape,\n      shape = _props$shape === void 0 ? \"rect\" : _props$shape,\n      isLoading = props.isLoading,\n      _props$fileType = props.fileType,\n      fileType = _props$fileType === void 0 ? \"image/jpeg\" : _props$fileType;\n\n  var _useState = useState(\"\"),\n      imageSrc = _useState[0],\n      setImageSrc = _useState[1];\n\n  var _useState2 = useState({\n    x: 0,\n    y: 0\n  }),\n      crop = _useState2[0],\n      setCrop = _useState2[1];\n\n  var _useState3 = useState(1),\n      zoom = _useState3[0],\n      setZoom = _useState3[1];\n\n  var _useState4 = useState({\n    x: 0,\n    y: 0,\n    width: 100,\n    height: 100\n  }),\n      croppedAreaPixels = _useState4[0],\n      setCroppedAreaPixels = _useState4[1];\n\n  var _useTranslation = useTranslation([\"common\"]),\n      t = _useTranslation.t;\n\n  useEffect(function () {\n    loadImage();\n  }, [image]);\n  useEffect(function () {\n    if (!isOpen) {\n      setZoom(1);\n      setImageSrc(\"\");\n    }\n  }, [isOpen]);\n\n  var loadImage = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var imageSrc;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return readFile(image);\n\n            case 2:\n              imageSrc = _context.sent;\n              setImageSrc(imageSrc);\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function loadImage() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleCropComplete = useCallback(function (croppedArea, _croppedAreaPixels) {\n    setCroppedAreaPixels(_croppedAreaPixels);\n  }, []);\n\n  var handleConfirm = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var croppedImage;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return getCroppedImg(imageSrc, croppedAreaPixels, fileType);\n\n            case 2:\n              croppedImage = _context2.sent;\n              onConfirm && onConfirm(croppedImage.file, croppedImage.base64File);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleConfirm() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleClose = function handleClose() {\n    onClose();\n  };\n\n  return /*#__PURE__*/_jsx(Transition, {\n    appear: true,\n    show: isOpen,\n    as: Fragment,\n    children: /*#__PURE__*/_jsx(Dialog, {\n      as: \"div\",\n      className: \"fixed inset-0 z-40 overflow-y-auto bg-grey bg-opacity-40\",\n      onClose: handleClose,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: \"min-h-screen px-1 text-center phone:px-4\",\n        children: [/*#__PURE__*/_jsx(Transition.Child, {\n          as: Fragment,\n          enter: \"ease-out duration-300\",\n          enterFrom: \"opacity-0\",\n          enterTo: \"opacity-100\",\n          leave: \"ease-in duration-200\",\n          leaveFrom: \"opacity-100\",\n          leaveTo: \"opacity-0\",\n          children: /*#__PURE__*/_jsx(Dialog.Overlay, {\n            className: \"fixed inset-0\"\n          })\n        }), /*#__PURE__*/_jsx(\"span\", {\n          className: \"inline-block h-screen align-middle\",\n          \"aria-hidden\": \"true\",\n          children: \"\\u200B\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"inline-block w-11/12 p-2 align-middle bg-white rounded-md h-50 laptop:w-80\",\n          children: /*#__PURE__*/_jsx(Transition.Child, {\n            as: Fragment,\n            enter: \"ease-out duration-300\",\n            enterFrom: \"opacity-0 scale-95\",\n            enterTo: \"opacity-100 scale-100\",\n            leave: \"ease-in duration-200\",\n            leaveFrom: \"opacity-100 scale-100\",\n            leaveTo: \"opacity-0 scale-95\",\n            children: /*#__PURE__*/_jsxs(\"div\", {\n              className: \"text-left transition-all transform shadow-xl rounded-2xl\",\n              children: [/*#__PURE__*/_jsx(\"div\", {\n                className: \"h-40 w-30\",\n                children: /*#__PURE__*/_jsx(Cropper, {\n                  image: imageSrc,\n                  crop: crop,\n                  zoom: zoom,\n                  aspect: aspect,\n                  onCropChange: setCrop,\n                  onCropComplete: handleCropComplete,\n                  onZoomChange: setZoom,\n                  cropShape: shape\n                })\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"absolute right-0 flex w-full -bottom-7 gap-x-1\",\n                children: [/*#__PURE__*/_jsx(Button, {\n                  type: \"button\",\n                  onClick: handleClose,\n                  className: \"w-1/2 border border-solid border-primary\",\n                  children: t(\"dialog.cancel\")\n                }), /*#__PURE__*/_jsx(Button, {\n                  primary: true,\n                  type: \"button\",\n                  loading: isLoading,\n                  onClick: handleConfirm,\n                  className: \"w-1/2\",\n                  children: !isLoading && t(\"dialog.confirm\")\n                })]\n              })]\n            })\n          })\n        })]\n      })\n    })\n  });\n};\n\nexport default ImageCropper;","map":null,"metadata":{},"sourceType":"module"}