{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { isEmpty } from \"lodash\";\nimport { renderLocation } from \"@common/functions\";\nimport { getUserCookies } from \"@common/utils/auth\";\nimport { Container, Content, Button, InfoWrapper, InfoItem, Link, Title, Wrapper, LinkWrapper, LinkDetail } from \"./styles\";\nimport { setAppliedRecruitment, setSeenRecruitment } from \"@redux/actions/recruitment\";\nimport { resetAction } from \"@redux/actions/common\";\nimport { getUserProfile } from \"@redux/actions/user\";\nimport { PATH } from \"@routes\";\n\nconst Opportunity = ({\n  recruitment\n}) => {\n  const {\n    t\n  } = useTranslation([\"company\"]);\n  const dispatch = useDispatch();\n  const {\n    user\n  } = useSelector(state => state.user);\n  const {\n    name,\n    level,\n    location,\n    slug,\n    _id\n  } = recruitment;\n  const locationString = renderLocation(location.map(item => {\n    var _item$province;\n\n    return item === null || item === void 0 ? void 0 : (_item$province = item.province) === null || _item$province === void 0 ? void 0 : _item$province.name;\n  }));\n  const {\n    currentUser\n  } = useSelector(state => state.auth);\n  const {\n    actionSuccess\n  } = useSelector(state => state.actions);\n  const {\n    0: isApplied,\n    1: setIsApplied\n  } = useState();\n  const userInfo = (currentUser === null || currentUser === void 0 ? void 0 : currentUser.userInfo) || {};\n  useEffect(() => {\n    getUserProfileAPI();\n  }, []);\n  useEffect(() => {\n    checkApplied();\n  }, [user]);\n  useEffect(() => {\n    if (actionSuccess) {\n      dispatch(resetAction());\n      getUserProfileAPI();\n      checkApplied();\n    }\n  }, [actionSuccess]);\n\n  const setAppliedRecruitmentAPI = (userId, recruitmentId) => {\n    const payload = {\n      userId: userId,\n      recruitmentId: recruitmentId\n    };\n    dispatch(setAppliedRecruitment(payload));\n  };\n\n  const getUserProfileAPI = () => {\n    var _getUserCookies, _getUserCookies$userI;\n\n    const payload = {\n      id: (_getUserCookies = getUserCookies()) === null || _getUserCookies === void 0 ? void 0 : (_getUserCookies$userI = _getUserCookies.userInfo) === null || _getUserCookies$userI === void 0 ? void 0 : _getUserCookies$userI._id\n    };\n    dispatch(getUserProfile(payload));\n  };\n\n  const handleApply = () => {\n    setAppliedRecruitmentAPI(userInfo === null || userInfo === void 0 ? void 0 : userInfo._id, _id);\n  };\n\n  const checkApplied = () => {\n    var _user$appliedRecruitm;\n\n    const listAppliedId = user === null || user === void 0 ? void 0 : (_user$appliedRecruitm = user.appliedRecruitment) === null || _user$appliedRecruitm === void 0 ? void 0 : _user$appliedRecruitm.map(item => {\n      var _item$recruitment;\n\n      return item === null || item === void 0 ? void 0 : (_item$recruitment = item.recruitment) === null || _item$recruitment === void 0 ? void 0 : _item$recruitment._id;\n    });\n\n    if (listAppliedId !== null && listAppliedId !== void 0 && listAppliedId.includes(_id)) {\n      setIsApplied(true);\n    }\n  };\n\n  const handleClickJob = () => {\n    if (isEmpty(userInfo)) return;\n    dispatch(setSeenRecruitment({\n      userId: userInfo === null || userInfo === void 0 ? void 0 : userInfo._id,\n      recruitmentId: _id\n    }));\n  };\n\n  return /*#__PURE__*/_jsx(Wrapper, {\n    children: /*#__PURE__*/_jsxs(Container, {\n      children: [/*#__PURE__*/_jsxs(Content, {\n        children: [/*#__PURE__*/_jsx(LinkWrapper, {\n          onClick: handleClickJob,\n          children: /*#__PURE__*/_jsx(LinkDetail, {\n            routeName: PATH.JOB_DETAIL,\n            params: {\n              slug: slug\n            },\n            children: /*#__PURE__*/_jsx(Title, {\n              title: name,\n              children: name\n            })\n          })\n        }), /*#__PURE__*/_jsxs(InfoWrapper, {\n          children: [/*#__PURE__*/_jsx(InfoItem, {\n            children: level === null || level === void 0 ? void 0 : level.name\n          }), /*#__PURE__*/_jsx(InfoItem, {\n            children: locationString\n          })]\n        })]\n      }), Object.keys(userInfo).length > 0 ? /*#__PURE__*/_jsx(Button, {\n        onClick: handleApply,\n        style: {\n          opacity: isApplied ? 0.5 : 1,\n          pointerEvents: isApplied ? \"none\" : \"initial\"\n        },\n        children: isApplied ? t(\"applied\") : t(\"apply\")\n      }) : /*#__PURE__*/_jsx(Link, {\n        routeName: PATH.LOGIN,\n        children: t(\"apply\")\n      })]\n    })\n  });\n};\n\nexport default Opportunity;","map":null,"metadata":{},"sourceType":"module"}