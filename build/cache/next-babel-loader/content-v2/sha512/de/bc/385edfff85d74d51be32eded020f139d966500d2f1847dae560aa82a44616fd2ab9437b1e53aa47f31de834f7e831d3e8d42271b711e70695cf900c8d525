{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { isEmpty } from \"lodash\";\nimport { renderLocation } from \"@common/functions\";\nimport { getUserCookies } from \"@common/utils/auth\";\nimport _Link from \"@designs/Link\";\nimport { PATH } from \"@routes\";\nimport { getUserProfile } from \"@redux/actions/user\";\nimport { setAppliedRecruitment, setSavedRecruitment } from \"@redux/actions/recruitment\";\nimport { resetAction } from \"@redux/actions/common\";\nimport { Button, ButtonWrapper, Container, CompanyName, Img, Link, Logo, Location, MainContent, OverviewWrapper, Salary, SalaryWrapper, Title, CompanyClick, Field } from \"./styles\";\nimport { setSeenCompany } from \"@redux/actions/company\";\nvar skeletonImage = \"/img/skeleton/default-small.jpg\";\n\nvar Overview = function Overview(_ref) {\n  var recruitment = _ref.recruitment;\n\n  var _useTranslation = useTranslation([\"job\"]),\n      t = _useTranslation.t;\n\n  var dispatch = useDispatch();\n  var companyLogo = recruitment.companyLogo,\n      companyName = recruitment.companyName,\n      companySlug = recruitment.companySlug,\n      location = recruitment.location,\n      name = recruitment.name,\n      salaryMax = recruitment.salaryMax,\n      company = recruitment.company,\n      dealSalary = recruitment.dealSalary;\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      user = _useSelector.user;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.auth;\n  }),\n      currentUser = _useSelector2.currentUser;\n\n  var _useSelector3 = useSelector(function (state) {\n    return state.actions;\n  }),\n      actionSuccess = _useSelector3.actionSuccess;\n\n  var _useState = useState(),\n      isApplied = _useState[0],\n      setIsApplied = _useState[1];\n\n  var _useState2 = useState(),\n      isSaved = _useState2[0],\n      setIsSaved = _useState2[1];\n\n  var userInfo = (currentUser === null || currentUser === void 0 ? void 0 : currentUser.userInfo) || {};\n  var locationArray = location === null || location === void 0 ? void 0 : location.map(function (item) {\n    return item.province.name;\n  });\n  var locationString = renderLocation(locationArray);\n  useEffect(function () {\n    getUserProfileAPI();\n  }, []);\n  useEffect(function () {\n    checkApplied();\n    checkSaved();\n  }, [user]);\n  useEffect(function () {\n    if (actionSuccess) {\n      dispatch(resetAction());\n      getUserProfileAPI();\n      checkApplied();\n      checkSaved();\n    }\n  }, [actionSuccess]);\n\n  var handleApply = function handleApply() {\n    setAppliedRecruitmentAPI(user === null || user === void 0 ? void 0 : user._id, recruitment === null || recruitment === void 0 ? void 0 : recruitment._id);\n  };\n\n  var handleSave = function handleSave() {\n    setSaveRecruitmentAPI(user === null || user === void 0 ? void 0 : user._id, recruitment === null || recruitment === void 0 ? void 0 : recruitment._id);\n  };\n\n  var setAppliedRecruitmentAPI = function setAppliedRecruitmentAPI(userId, recruitmentId) {\n    var payload = {\n      userId: userId,\n      recruitmentId: recruitmentId\n    };\n    dispatch(setAppliedRecruitment(payload));\n  };\n\n  var setSaveRecruitmentAPI = function setSaveRecruitmentAPI(userId, recruitmentId) {\n    var payload = {\n      userId: userId,\n      recruitmentId: recruitmentId\n    };\n    dispatch(setSavedRecruitment(payload));\n  };\n\n  var getUserProfileAPI = function getUserProfileAPI() {\n    var _getUserCookies, _getUserCookies$userI;\n\n    var payload = {\n      id: (_getUserCookies = getUserCookies()) === null || _getUserCookies === void 0 ? void 0 : (_getUserCookies$userI = _getUserCookies.userInfo) === null || _getUserCookies$userI === void 0 ? void 0 : _getUserCookies$userI._id\n    };\n    dispatch(getUserProfile(payload));\n  };\n\n  var checkApplied = function checkApplied() {\n    var _user$appliedRecruitm;\n\n    var listAppliedId = user === null || user === void 0 ? void 0 : (_user$appliedRecruitm = user.appliedRecruitment) === null || _user$appliedRecruitm === void 0 ? void 0 : _user$appliedRecruitm.map(function (item) {\n      var _item$recruitment;\n\n      return item === null || item === void 0 ? void 0 : (_item$recruitment = item.recruitment) === null || _item$recruitment === void 0 ? void 0 : _item$recruitment._id;\n    });\n\n    if (listAppliedId !== null && listAppliedId !== void 0 && listAppliedId.includes(recruitment === null || recruitment === void 0 ? void 0 : recruitment._id)) {\n      setIsApplied(true);\n    }\n  };\n\n  var checkSaved = function checkSaved() {\n    var _user$savedRecruitmen;\n\n    var listSavedId = user === null || user === void 0 ? void 0 : (_user$savedRecruitmen = user.savedRecruitment) === null || _user$savedRecruitmen === void 0 ? void 0 : _user$savedRecruitmen.map(function (item) {\n      return item === null || item === void 0 ? void 0 : item._id;\n    });\n\n    if (listSavedId !== null && listSavedId !== void 0 && listSavedId.includes(recruitment === null || recruitment === void 0 ? void 0 : recruitment._id)) {\n      setIsSaved(true);\n    }\n  };\n\n  var handleSetSeenCompany = function handleSetSeenCompany() {\n    if (isEmpty(userInfo)) return;\n    dispatch(setSeenCompany({\n      companyId: company === null || company === void 0 ? void 0 : company._id,\n      userId: userInfo === null || userInfo === void 0 ? void 0 : userInfo._id\n    }));\n  };\n\n  return /*#__PURE__*/_jsx(OverviewWrapper, {\n    children: /*#__PURE__*/_jsxs(Container, {\n      children: [/*#__PURE__*/_jsx(Logo, {\n        children: /*#__PURE__*/_jsx(Img, {\n          src: (companyLogo === null || companyLogo === void 0 ? void 0 : companyLogo.small) || (companyLogo === null || companyLogo === void 0 ? void 0 : companyLogo[\"default\"]) || (companyLogo === null || companyLogo === void 0 ? void 0 : companyLogo.medium) || skeletonImage,\n          alt: name,\n          loading: \"lazy\"\n        })\n      }), /*#__PURE__*/_jsxs(MainContent, {\n        children: [/*#__PURE__*/_jsx(Title, {\n          children: name\n        }), /*#__PURE__*/_jsx(CompanyClick, {\n          onClick: handleSetSeenCompany,\n          children: /*#__PURE__*/_jsx(CompanyName, {\n            routeName: PATH.COMPANY_RECRUITMENT,\n            params: {\n              slug: companySlug\n            },\n            children: companyName\n          })\n        }), /*#__PURE__*/_jsxs(Location, {\n          children: [t(\"location\"), \": \", locationString]\n        }), /*#__PURE__*/_jsxs(SalaryWrapper, {\n          children: [/*#__PURE__*/_jsxs(Field, {\n            children: [t(\"salary\"), \": \"]\n          }), /*#__PURE__*/_jsx(Salary, {\n            children: isEmpty(userInfo) ? /*#__PURE__*/_jsx(_Link, {\n              routeName: PATH.LOGIN,\n              children: t(\"login-to-see\")\n            }) : dealSalary ? t(\"deal-salary\") : \"\".concat(salaryMax, \" \").concat(t(\"unit\"))\n          })]\n        }), /*#__PURE__*/_jsxs(ButtonWrapper, {\n          children: [Object.keys(userInfo).length > 0 ? /*#__PURE__*/_jsx(Button, {\n            onClick: handleApply,\n            style: {\n              opacity: isApplied ? 0.5 : 1,\n              pointerEvents: isApplied ? \"none\" : \"initial\"\n            },\n            children: isApplied ? t(\"applied\") : t(\"apply\")\n          }) : /*#__PURE__*/_jsx(Link, {\n            routeName: PATH.LOGIN,\n            children: t(\"apply\")\n          }), Object.keys(userInfo).length > 0 ? /*#__PURE__*/_jsx(Button, {\n            onClick: handleSave,\n            style: {\n              opacity: isSaved ? 0.5 : 1,\n              pointerEvents: isSaved ? \"none\" : \"initial\"\n            },\n            children: isSaved ? t(\"saved-job\") : t(\"save-job\")\n          }) : /*#__PURE__*/_jsx(Link, {\n            routeName: PATH.LOGIN,\n            children: t(\"save-job\")\n          })]\n        })]\n      })]\n    })\n  });\n};\n\nexport default Overview;","map":null,"metadata":{},"sourceType":"module"}