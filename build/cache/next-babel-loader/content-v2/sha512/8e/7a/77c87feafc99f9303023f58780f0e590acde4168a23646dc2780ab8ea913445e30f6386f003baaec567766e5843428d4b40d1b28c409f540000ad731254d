{"ast":null,"code":"import _defineProperty from \"/data/source/tuyendungvn-user-frontend-nextjs/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"/data/source/tuyendungvn-user-frontend-nextjs/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Fragment, useState, useEffect } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useTranslation } from \"next-i18next\";\nimport { useRouter } from \"next/router\";\nimport { Transition } from \"@headlessui/react\";\nimport { useClickOutSide } from \"@common/hooks/useClickOutSide\";\nimport { formatParams } from \"@common/functions\";\nimport AutoComplete from \"@designs/AutoComplete\";\nimport { SVG } from \"@designs/SVG\";\nimport { Button, CommonKeyword, CommonKeywordContent, CommonKeywordItem, Dropdown, DropdownMobile, Form, Input, ListBoxItem, ListBoxMenu, RecentSearch, RecentSearchItem, SearchBoxContainer, SearchIcon, TextField, Title } from \"./styles\";\n\nvar SearchBox = function SearchBox(props) {\n  var _props$className = props.className,\n      className = _props$className === void 0 ? \"\" : _props$className,\n      onSubmit = props.onSubmit,\n      _props$listSearchCurr = props.listSearchCurrent,\n      listSearchCurrent = _props$listSearchCurr === void 0 ? [] : _props$listSearchCurr,\n      _props$hasProvince = props.hasProvince,\n      hasProvince = _props$hasProvince === void 0 ? false : _props$hasProvince,\n      _props$value = props.value,\n      value = _props$value === void 0 ? \"\" : _props$value;\n\n  var _useTranslation = useTranslation([\"common\"]),\n      t = _useTranslation.t;\n\n  var fullQuery = useRouter().query || {};\n\n  var _useClickOutSide = useClickOutSide(false),\n      elementRef = _useClickOutSide.elementRef,\n      setElementVisible = _useClickOutSide.setElementVisible;\n\n  var _province = fullQuery.province;\n  var queryProvince = formatParams(decodeURIComponent(_province || \"\"));\n\n  var _useSelector = useSelector(function (state) {\n    return state.recruitment;\n  }),\n      _useSelector$mostKeyw = _useSelector.mostKeyword,\n      mostKeyword = _useSelector$mostKeyw === void 0 ? [] : _useSelector$mostKeyw;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.location;\n  }),\n      provinces = _useSelector2.provinces;\n\n  var _useState = useState(\"\"),\n      inputValue = _useState[0],\n      setInputValue = _useState[1];\n\n  var _useState2 = useState(),\n      provinceSelected = _useState2[0],\n      setProvinceSelected = _useState2[1];\n\n  var _useState3 = useState([]),\n      listProvince = _useState3[0],\n      setListProvince = _useState3[1];\n\n  var _useState4 = useState(false),\n      isOpenDropdown = _useState4[0],\n      setIsOpenDropdown = _useState4[1];\n\n  var _useState5 = useState([]),\n      hotKeywords = _useState5[0],\n      setHotKeywords = _useState5[1];\n\n  useEffect(function () {\n    addOptionToProvince();\n  }, [provinces]);\n  useEffect(function () {\n    if (value) {\n      setInputValue(value);\n    } else {\n      setInputValue(\"\");\n    }\n  }, [value]);\n  useEffect(function () {\n    if ((mostKeyword === null || mostKeyword === void 0 ? void 0 : mostKeyword.length) > 0) {\n      var hotKeyword = mostKeyword === null || mostKeyword === void 0 ? void 0 : mostKeyword.filter(function (keyword) {\n        return keyword.isHot === true;\n      });\n      setHotKeywords(hotKeyword);\n    }\n  }, [mostKeyword]);\n  useEffect(function () {\n    if (queryProvince) {\n      var _provinceSelected = listProvince === null || listProvince === void 0 ? void 0 : listProvince.find(function (item) {\n        return (item === null || item === void 0 ? void 0 : item.slug) === queryProvince;\n      });\n\n      setProvinceSelected(_provinceSelected);\n    } else {\n      setProvinceSelected(listProvince[0]);\n    }\n  }, [listProvince, fullQuery]);\n\n  var handleSelectProvince = function handleSelectProvince(option) {\n    setProvinceSelected(option);\n    onSubmit && onSubmit(inputValue, option === null || option === void 0 ? void 0 : option.slug);\n  };\n\n  var addOptionToProvince = function addOptionToProvince() {\n    var draftArray = _toConsumableArray(provinces);\n\n    var allProvince = {\n      name: t(\"filter-all-location\")\n    };\n    draftArray.unshift(allProvince);\n    setListProvince(draftArray);\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    onSubmit && onSubmit(inputValue, provinceSelected === null || provinceSelected === void 0 ? void 0 : provinceSelected.slug);\n    e.preventDefault();\n    setIsOpenDropdown(false);\n  };\n\n  var handleChange = function handleChange(e) {\n    setInputValue(e.target.value);\n    setIsOpenDropdown(true);\n  };\n\n  var handleClickSuggest = function handleClickSuggest(e, value) {\n    setInputValue(value);\n    onSubmit && onSubmit(value, provinceSelected === null || provinceSelected === void 0 ? void 0 : provinceSelected.slug);\n    e.preventDefault();\n  };\n\n  var handleClickKeyword = function handleClickKeyword(e, keyword) {\n    setInputValue(value);\n    onSubmit && onSubmit(keyword === null || keyword === void 0 ? void 0 : keyword.name, provinceSelected === null || provinceSelected === void 0 ? void 0 : provinceSelected.slug);\n    e.preventDefault();\n  };\n\n  var handleFocus = function handleFocus() {\n    setElementVisible(true);\n    setIsOpenDropdown(true);\n  };\n\n  var handleClose = function handleClose() {\n    setIsOpenDropdown(false);\n  };\n\n  return /*#__PURE__*/_jsx(SearchBoxContainer, {\n    className: className,\n    ref: elementRef,\n    hasProvince: true,\n    children: /*#__PURE__*/_jsxs(Form, {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxs(TextField, {\n        hasProvince: hasProvince,\n        children: [/*#__PURE__*/_jsx(SearchIcon, {\n          className: \"h-2 text-black min-w-2\"\n        }), /*#__PURE__*/_jsx(Input, {\n          value: inputValue,\n          onFocus: handleFocus,\n          onBlur: handleClose,\n          placeholder: t(\"search-box.place-holder\"),\n          onChange: handleChange\n        })]\n      }), /*#__PURE__*/_jsx(Transition, {\n        show: isOpenDropdown,\n        as: Fragment,\n        enter: \"transition ease-out duration-100\",\n        enterFrom: \"transform opacity-0\",\n        enterTo: \"transform opacity-100\",\n        leave: \"transition ease-in duration-75\",\n        leaveFrom: \"transform opacity-100\",\n        leaveTo: \"transform opacity-0\",\n        children: /*#__PURE__*/_jsxs(Dropdown, {\n          children: [/*#__PURE__*/_jsxs(RecentSearch, {\n            children: [/*#__PURE__*/_jsx(Title, {\n              children: t(\"search-box.recent-search\")\n            }), (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.length) > 0 && (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.filter(function (text, index) {\n              return index > (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.length) - 6;\n            }).map(function (value, index) {\n              return /*#__PURE__*/_jsx(RecentSearchItem, {\n                onClick: function onClick(e) {\n                  return handleClickSuggest(e, value);\n                },\n                children: value\n              }, index);\n            }))]\n          }), /*#__PURE__*/_jsxs(CommonKeyword, {\n            children: [/*#__PURE__*/_jsx(Title, {\n              children: t(\"search-box.common-keyword\")\n            }), /*#__PURE__*/_jsx(CommonKeywordContent, {\n              children: (hotKeywords === null || hotKeywords === void 0 ? void 0 : hotKeywords.length) > 0 && hotKeywords.map(function (keyword, index) {\n                return /*#__PURE__*/_jsx(CommonKeywordItem, {\n                  onClick: function onClick(e) {\n                    return handleClickKeyword(e, keyword);\n                  },\n                  children: keyword === null || keyword === void 0 ? void 0 : keyword.name\n                }, index);\n              })\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsx(Transition, {\n        show: isOpenDropdown,\n        as: Fragment,\n        enter: \"transition ease-out duration-100\",\n        enterFrom: \"transform opacity-0\",\n        enterTo: \"transform opacity-100\",\n        leave: \"transition ease-in duration-75\",\n        leaveFrom: \"transform opacity-100\",\n        leaveTo: \"transform opacity-0\",\n        children: /*#__PURE__*/_jsx(DropdownMobile, {\n          children: /*#__PURE__*/_jsxs(RecentSearch, {\n            children: [/*#__PURE__*/_jsx(Title, {\n              children: t(\"search-box.recent-search\")\n            }), (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.length) > 0 && (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.filter(function (text, index) {\n              return index > (listSearchCurrent === null || listSearchCurrent === void 0 ? void 0 : listSearchCurrent.length) - 6;\n            }).map(function (value, index) {\n              return /*#__PURE__*/_jsx(RecentSearchItem, {\n                onClick: function onClick(e) {\n                  return handleClickSuggest(e, value);\n                },\n                children: value\n              }, index);\n            }))]\n          })\n        })\n      }), hasProvince && /*#__PURE__*/_jsx(AutoComplete, {\n        className: \"w-full laptop:w-26.5\",\n        MenuButton: /*#__PURE__*/_jsxs(ListBoxMenu, {\n          children: [/*#__PURE__*/_jsx(SVG, {\n            name: \"common/location\",\n            width: \"24\",\n            height: \"24\"\n          }), provinceSelected === null || provinceSelected === void 0 ? void 0 : provinceSelected.name]\n        }),\n        fieldToSearch: [\"name\", \"nameEn\"],\n        onChange: handleSelectProvince,\n        optionSelected: provinceSelected,\n        options: listProvince,\n        renderItem: function renderItem(option) {\n          return /*#__PURE__*/_jsx(ListBoxItem, {\n            children: option === null || option === void 0 ? void 0 : option.name\n          });\n        }\n      }), /*#__PURE__*/_jsx(Button, {\n        type: \"submit\",\n        children: /*#__PURE__*/_jsx(\"p\", {\n          className: \"phone:block\",\n          children: t(\"search-box.search\")\n        })\n      })]\n    })\n  });\n};\n\nexport default SearchBox;\n\nvar removeParams = function removeParams(_query) {\n  var newQuery = _objectSpread({}, _query);\n\n  delete newQuery.province;\n  delete newQuery.career;\n  delete newQuery.salary;\n  delete newQuery.level;\n  delete newQuery.type;\n  return newQuery || {};\n};","map":null,"metadata":{},"sourceType":"module"}